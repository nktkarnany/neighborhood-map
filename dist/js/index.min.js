function initMap(){setTimeout(function(){window.google&&window.google.maps||alert("Not able to load google maps...Please try again later!!")},5e3),map=new google.maps.Map(document.getElementById("map"),{center:model.currentLocation,zoom:14}),getCurrentLocation()}function getCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):console.log("Geolocation is not supported by this browser.")}function showPosition(e){model.currentLocation.lat=e.coords.latitude,model.currentLocation.lng=e.coords.longitude,map.setCenter(model.currentLocation),getPlaces()}function getPlaces(){var e={location:model.currentLocation,radius:"500",types:model.selectedTypes};new google.maps.places.PlacesService(map).nearbySearch(e,callback)}function callback(e,o){o==google.maps.places.PlacesServiceStatus.OK&&(model.places=e,viewModel.places(e),viewModel.places=ko.computed(function(){var e=viewModel.query().toLowerCase();return ko.utils.arrayFilter(model.places,function(o){return o.name.toLowerCase().indexOf(e)>=0})}))}var model={currentPlace:"Chelsea, New York",currentLocation:{lat:40.74135,lng:-73.99802},places:[],filteredPlaces:[],types:["restaurant","store","bank","hospital"],selectedTypes:["restaurant"]},viewModel={currentPlace:ko.observable(model.currentPlace),toggle:ko.observable(!0),toggleMenu:function(){this.toggle(!this.toggle())},types:ko.observableArray(model.types),selectedTypes:ko.observableArray(model.selectedTypes),places:ko.observableArray(model.places),showDetail:function(e){},hideDetail:function(e){},query:ko.observable("")};ko.applyBindings(viewModel);var map;
