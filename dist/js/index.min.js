function initMap(){setTimeout(function(){window.google&&window.google.maps||alert("Not able to load google maps...Please try again later!!")},5e3),map=new google.maps.Map(document.getElementById("map"),{center:model.currentLocation,zoom:14}),getCurrentLocation()}function getCurrentLocation(){navigator.geolocation?navigator.geolocation.getCurrentPosition(showPosition):(console.log("Geolocation is not supported by this browser."),initModel())}function showPosition(o){model.currentLocation.lat=o.coords.latitude,model.currentLocation.lng=o.coords.longitude,map.setCenter(model.currentLocation),getPlaces()}function getPlaces(){var o={location:model.currentLocation,radius:"500",types:["restaurant"]};new google.maps.places.PlacesService(map).nearbySearch(o,callback)}function callback(o,e){e==google.maps.places.PlacesServiceStatus.OK&&(model.places=o,initModel())}function initModel(){model.places.forEach(function(o){markers.push(new google.maps.Marker({position:{lat:o.geometry.location.lat(),lng:o.geometry.location.lng()},map:map}))});var o={toggle:ko.observable(!0),toggleMenu:function(){this.toggle(!this.toggle())},showDetail:function(o){},hideDetail:function(o){},query:ko.observable(""),places:ko.pureComputed(function(){var e=o.query().toLowerCase();return ko.utils.arrayFilter(model.places,function(o,t){return o.name.toLowerCase().indexOf(e)>=0?(markers[t].setMap(map),!0):(markers[t].setMap(null),!1)})})};ko.applyBindings(o)}var model={currentPlace:"Chelsea, New York",currentLocation:{lat:40.74135,lng:-73.99802},places:[]},map,markers=[];
